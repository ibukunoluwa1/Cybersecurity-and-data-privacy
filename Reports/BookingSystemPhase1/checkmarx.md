# Penetration Test Report

## 1️⃣ Summary
This penetration test report documents security vulnerabilities found in the application's registration page. The report includes previous issues that have been fixed and new findings from the Checkmarx ZAP scan.

---

## 2️⃣ Fixed Issues

✅ **SQL Injection** → Input sanitization has been implemented using prepared statements.
✅ **Cross-Site Scripting (XSS)** → HTML encoding and CSP headers applied.
✅ **CSRF Protection** → CSRF tokens now implemented in all forms.
✅ **Password Security** → Passwords are now stored using bcrypt hashing.
✅ **Rate Limiting** → Brute-force attacks mitigated with failed attempt lockouts.
✅ **Error Message Disclosure** → Generic error messages now in place.

---

## 3️⃣ New Findings

### 🔹 **Insecure Direct Object References (IDOR) - High Risk**
**Observation:**
- User profiles can be accessed by changing the user ID in the URL.

**Impact:**
- Unauthorized users can access sensitive user data.

**Fix Recommendation:**
- Implement access controls using session-based validation.
- Use UUIDs instead of sequential IDs.

### 🔹 **Broken Authentication - Critical Risk**
**Observation:**
- Users can bypass authentication using modified session tokens.

**Impact:**
- Attackers can gain unauthorized access to user accounts.

**Fix Recommendation:**
- Implement secure session management practices.
- Use HttpOnly and Secure attributes for cookies.

### 🔹 **Unvalidated Redirects & Forwards - Medium Risk**
**Observation:**
- User input is used to construct URLs without validation.

**Impact:**
- Phishing attacks possible through URL manipulation.

**Fix Recommendation:**
- Use a whitelist of allowed redirect destinations.
- Validate and sanitize user inputs.

### 🔹 **Security Headers Missing - Medium Risk**
**Observation:**
- The following headers are missing:
  - `Strict-Transport-Security`
  - `X-Content-Type-Options`
  - `X-Frame-Options`

**Impact:**
- Increased risk of MITM and clickjacking attacks.

**Fix Recommendation:**
- Implement security headers via server configuration.

### 🔹 **ZAP Scan Findings**
A new OWASP ZAP scan was conducted, and the key issues are listed below:

| Issue | Risk Level |
|---|---|
| Missing Security Headers | Medium |
| Open Ports Detected | High |
| Unrestricted File Upload | Critical |
| Outdated Libraries | High |

The full Checkmarx ZAP scan report has been added to the security assessment folder.

---

## 4️⃣ Final Recommendations
✅ Enforce role-based access control (RBAC).
✅ Implement secure session and token management.
✅ Secure URL redirects to prevent phishing.
✅ Enforce HTTP security headers.
✅ Regularly update libraries and dependencies.
✅ Perform frequent penetration tests and code audits.

---

**Next Steps:**
- [ ] Address IDOR vulnerability in user profiles.
- [ ] Secure authentication mechanisms.
- [ ] Enforce security headers.
- [ ] Review file upload policies.

**Report Generated By:** _Ibukun Olomiyesan_
